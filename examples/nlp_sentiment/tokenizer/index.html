
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Library for machine learning models">
      
      
      
      
        <link rel="prev" href="../intro/">
      
      
        <link rel="next" href="../vectorizer/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.26">
    
    
      
        <title>Tokenizer - modelkit documentation</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.6543a935.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#installation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="modelkit documentation" class="md-header__button md-logo" aria-label="modelkit documentation" data-md-component="logo">
      
  <img src="../../../logo_docs.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            modelkit documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Tokenizer
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/Cornerstone-OnDemand/modelkit" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    Cornerstone-OnDemand/modelkit
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="modelkit documentation" class="md-nav__button md-logo" aria-label="modelkit documentation" data-md-component="logo">
      
  <img src="../../../logo_docs.svg" alt="logo">

    </a>
    modelkit documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Cornerstone-OnDemand/modelkit" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    Cornerstone-OnDemand/modelkit
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../migration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Migration note
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Developer guide
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Developer guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../library/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Models
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Models
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../library/models/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../library/models/using_models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting predictions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../library/models/configuring_models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuring models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../library/models/model_with_load/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model loading
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../library/models/models_with_dependencies/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dependencies
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../library/models/validation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Validation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../library/models/batching/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Batching
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../library/models/testing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Testing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../library/models/asynchronous_models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Async
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../library/models/organizing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Organizing models
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Model Library
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Model Library
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../library/model_library/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model library
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../library/caching/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Caching
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../library/lazy_loading/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lazy loading
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Assets
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            Assets
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../assets/remote_assets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Remote assets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../assets/storage_provider/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Storage provider
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../assets/managing_assets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Managing assets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../assets/retrieving_assets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Retrieving assets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../assets/assets_dir/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Local assets dir
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../assets/store_organization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Remote store organization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../assets/versioning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Versioning systems
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5" >
        
          
          <label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Special models
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5">
            <span class="md-nav__icon md-icon"></span>
            Special models
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../library/special/tensorflow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tensorflow models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../library/special/distant/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Distant Models
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6" >
        
          
          <label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Profilers
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_6">
            <span class="md-nav__icon md-icon"></span>
            Profilers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../library/profilers/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../library/profilers/simple_profiler/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SimpleProfiler
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" checked>
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    NLP x Sentiment Analysis
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            NLP x Sentiment Analysis
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../intro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Intro
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Tokenizer
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Tokenizer
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    <span class="md-ellipsis">
      Installation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple-model-predict" class="md-nav__link">
    <span class="md-ellipsis">
      Simple Model predict
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Simple Model predict">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#complex-model-initialization" class="md-nav__link">
    <span class="md-ellipsis">
      Complex Model initialization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#batch-computation" class="md-nav__link">
    <span class="md-ellipsis">
      Batch computation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#additional-features" class="md-nav__link">
    <span class="md-ellipsis">
      Additional features
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Additional features">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tests" class="md-nav__link">
    <span class="md-ellipsis">
      Tests
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#input-and-output-specification" class="md-nav__link">
    <span class="md-ellipsis">
      Input and output specification
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Conclusion">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#final-tokenizer-code" class="md-nav__link">
    <span class="md-ellipsis">
      Final Tokenizer code
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../vectorizer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vectorizer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../classifier/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Classifier
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../advanced_models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Advanced models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tldr/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TL;DR
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tf_hub/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Loading Model from TF Hub
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuration
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cli/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CLI
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Deployment
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Deployment
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../deployment/deployment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Automatic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../deployment/integrate_fastapi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Integrate in existing app
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../assets/environment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Environment
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    <span class="md-ellipsis">
      Installation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple-model-predict" class="md-nav__link">
    <span class="md-ellipsis">
      Simple Model predict
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Simple Model predict">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#complex-model-initialization" class="md-nav__link">
    <span class="md-ellipsis">
      Complex Model initialization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#batch-computation" class="md-nav__link">
    <span class="md-ellipsis">
      Batch computation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#additional-features" class="md-nav__link">
    <span class="md-ellipsis">
      Additional features
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Additional features">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tests" class="md-nav__link">
    <span class="md-ellipsis">
      Tests
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#input-and-output-specification" class="md-nav__link">
    <span class="md-ellipsis">
      Input and output specification
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Conclusion">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#final-tokenizer-code" class="md-nav__link">
    <span class="md-ellipsis">
      Final Tokenizer code
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>Tokenizer</h1>

<p>In this section, we will cover the basics of <code>modelkit</code>'s API, and use spaCy as tokenizer for our NLP pipeline.</p>
<h2 id="installation">Installation<a class="headerlink" href="#installation" title="Permanent link">&para;</a></h2>
<p>Once you have set up a fresh python environment, let's install <code>modelkit</code>, <code>spacy</code> and grab the small english model.</p>
<div class="highlight"><pre><span></span><code>pip install modelkit spacy
python -m spacy download en_core_web_sm
</code></pre></div>
<h2 id="simple-model-predict">Simple Model predict<a class="headerlink" href="#simple-model-predict" title="Permanent link">&para;</a></h2>
<p>To define a modelkit <code>Model</code>, you need to:</p>
<ul>
<li>create a class inheriting from <code>modelkit.Model</code> </li>
<li>implement a <code>_predict</code> method</li>
</ul>
<p>To begin with, let's create a minimal tokenizer:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">modelkit</span>


<span class="k">class</span> <span class="nc">Tokenizer</span><span class="p">(</span><span class="n">modelkit</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">_predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</code></pre></div>
<p>That's it! It is <em>very</em> minimal, but sufficient to define a modelkit <code>Model</code>.</p>
<p>You can now instantiate and call the <code>Model</code>:</p>
<div class="highlight"><pre><span></span><code><span class="n">tokenizer</span> <span class="o">=</span> <span class="n">Tokenizer</span><span class="p">()</span>

<span class="n">tokenizer</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="s2">&quot;I am a Data Scientist from Amiens, France&quot;</span><span class="p">)</span>
</code></pre></div>
<details class="note">
<summary>Other ways to call predict</summary>
<p>It is also possible to get predictions for batches (lists of items):</p>
<div class="highlight"><pre><span></span><code><span class="n">tokenizer</span><span class="o">.</span><span class="n">predict_batch</span><span class="p">([</span>
    <span class="s2">&quot;I am a Data Scientist from Amiens, France&quot;</span><span class="p">,</span> 
    <span class="s2">&quot;And I use modelkit&quot;</span>
<span class="p">])</span>
</code></pre></div>
<p>or call predict as a generator:</p>
<div class="highlight"><pre><span></span><code><span class="k">for</span> <span class="n">prediction</span> <span class="ow">in</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">predict_gen</span><span class="p">((</span><span class="s2">&quot;I am a Data Scientist from Amiens, France&quot;</span><span class="p">,)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">prediction</span><span class="p">)</span>
</code></pre></div>
</details>
<h3 id="complex-model-initialization">Complex <code>Model</code> initialization<a class="headerlink" href="#complex-model-initialization" title="Permanent link">&para;</a></h3>
<p>Let's now use <a href="https://spacy.io/">spaCy</a> to get closer to a production-ready tokenizer.</p>
<p>This will also help demonstrate additional Modelkit features.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">modelkit</span>
<span class="kn">import</span> <span class="nn">spacy</span>

<span class="k">class</span> <span class="nc">Tokenizer</span><span class="p">(</span><span class="n">modelkit</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">_load</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nlp</span> <span class="o">=</span> <span class="n">spacy</span><span class="o">.</span><span class="n">load</span><span class="p">(</span>
            <span class="s2">&quot;en_core_web_sm&quot;</span><span class="p">,</span>
            <span class="n">disable</span><span class="o">=</span><span class="p">[</span>
                <span class="s2">&quot;parser&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ner&quot;</span><span class="p">,</span>
                <span class="s2">&quot;tagger&quot;</span><span class="p">,</span>
                <span class="s2">&quot;lemmatizer&quot;</span><span class="p">,</span>
                <span class="s2">&quot;tok2vec&quot;</span><span class="p">,</span>
                <span class="s2">&quot;attribute_ruler&quot;</span><span class="p">,</span>
            <span class="p">],</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
        <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&lt;br&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;/&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="n">t</span><span class="o">.</span><span class="n">lower_</span>
            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nlp</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>  <span class="c1"># self.nlp is guaranteed to be initialized</span>
            <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">is_ascii</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">is_punct</span> <span class="ow">or</span> <span class="n">t</span><span class="o">.</span><span class="n">is_stop</span> <span class="ow">or</span> <span class="n">t</span><span class="o">.</span><span class="n">is_digit</span><span class="p">)</span>
        <span class="p">]</span>
</code></pre></div>
<p>We implement a <code>_load</code> method, which is where any asset, artifact, and other complex model attributes are created. </p>
<p>This method will be called exactly once in the lifetime of the <code>Model</code> object. </p>
<p>We define the spacy pipeline in the <code>_load</code> method (as opposed to <code>_predict</code> or the <code>__init__</code> methods), because it allows your model to benefit from advanced <code>modelkit</code> features such as <em>lazy loading</em> and <em>dependency management</em>.</p>
<p>Since we will only be using the tokenizer and not the many other cool spacy features, let's not forget to disable them.</p>
<p>We can instantiate the model and get predictions as before:
<div class="highlight"><pre><span></span><code><span class="n">tokenizer</span> <span class="o">=</span> <span class="n">Tokenizer</span><span class="p">()</span> <span class="c1"># _load is called</span>
<span class="n">tokenizer</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="s2">&quot;spaCy is a great lib for NLP 😀&quot;</span><span class="p">)</span>
<span class="c1"># [&#39;spacy&#39;, &#39;great&#39;, &#39;lib&#39;, &#39;nlp&#39;]</span>
</code></pre></div></p>
<h3 id="batch-computation">Batch computation<a class="headerlink" href="#batch-computation" title="Permanent link">&para;</a></h3>
<p>So far, we have only implemented the <code>_predict</code> method, which tokenizes items one by one. </p>
<p>In many instances, however, models will be called with many items at once, and we can leverage vectorization for speedups. This is particularly true when using other frameworks (Numpy, spaCy, Tensorflow, PyTorch etc.), or distant calls (TF Serving, database accesses etc.).</p>
<p>To leverage batching, modelkit allows you to define a <code>_predict_batch</code> method to process lists of items, and thus <em>kill multiple birds with one stone</em>.</p>
<p>Here we use spaCy's <code>pipe</code> method to tokenize items in batch:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">modelkit</span>
<span class="kn">import</span> <span class="nn">spacy</span>


<span class="k">class</span> <span class="nc">Tokenizer</span><span class="p">(</span><span class="n">modelkit</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">_load</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nlp</span> <span class="o">=</span> <span class="n">spacy</span><span class="o">.</span><span class="n">load</span><span class="p">(</span>
            <span class="s2">&quot;en_core_web_sm&quot;</span><span class="p">,</span>
            <span class="n">disable</span><span class="o">=</span><span class="p">[</span>
                <span class="s2">&quot;parser&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ner&quot;</span><span class="p">,</span>
                <span class="s2">&quot;tagger&quot;</span><span class="p">,</span>
                <span class="s2">&quot;lemmatizer&quot;</span><span class="p">,</span>
                <span class="s2">&quot;tok2vec&quot;</span><span class="p">,</span>
                <span class="s2">&quot;attribute_ruler&quot;</span><span class="p">,</span>
            <span class="p">],</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_predict_batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">texts</span><span class="p">):</span>
        <span class="n">texts</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&lt;br&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;/&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
            <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">texts</span>
        <span class="p">]</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="p">[</span>
                <span class="n">t</span><span class="o">.</span><span class="n">lower_</span>
                <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">text</span>
                <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">is_ascii</span>
                <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span>
                <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">is_punct</span> <span class="ow">or</span> <span class="n">t</span><span class="o">.</span><span class="n">is_stop</span> <span class="ow">or</span> <span class="n">t</span><span class="o">.</span><span class="n">is_digit</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nlp</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">texts</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">texts</span><span class="p">))</span>
        <span class="p">]</span>
</code></pre></div>
<p>Compared to the implementation with a <code>_predict</code> call, the time needed to tokenize batches of data is divided by 2.</p>
<p>For example, using ipython's <code>timeit</code> to process a list of a 100 strings:
<div class="highlight"><pre><span></span><code>%timeit [Tokenizer().predict(&quot;spaCy is a great lib for NLP&quot;) for _ in range(100)]
# 11.1 ms ± 203 µs per loop on a 2020 Macbook Pro.

%timeit Tokenizer().predict_batch([&quot;spaCy is a great lib for NLP] * 100, batch_size=64)
# 5.5 ms ± 105 µs per loop on a 2020 Macbook Pro.
</code></pre></div></p>
<details class="note">
<summary>Caching predictions</summary>
<p><code>modelkit</code> also allows you to use prediction caching (using Redis, or Python native caches) to improve computation times when the same items are seen over and over</p>
</details>
<h2 id="additional-features">Additional features<a class="headerlink" href="#additional-features" title="Permanent link">&para;</a></h2>
<h3 id="tests">Tests<a class="headerlink" href="#tests" title="Permanent link">&para;</a></h3>
<p>So far the tokenizer is relatively simple, but it is always useful to test your code.</p>
<p><code>modelkit</code> encourages you to add test cases alongside the <code>Model</code> class definition to ensure that it behaves as intended, and serve as documentation.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">modelkit</span>
<span class="kn">import</span> <span class="nn">spacy</span>


<span class="k">class</span> <span class="nc">Tokenizer</span><span class="p">(</span><span class="n">modelkit</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">TEST_CASES</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">{</span><span class="s2">&quot;item&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="p">[]},</span>
        <span class="p">{</span><span class="s2">&quot;item&quot;</span><span class="p">:</span> <span class="s2">&quot;NLP 101&quot;</span><span class="p">,</span> <span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;nlp&quot;</span><span class="p">]},</span>
        <span class="p">{</span>
            <span class="s2">&quot;item&quot;</span><span class="p">:</span> <span class="s2">&quot;I&#39;m loving the spaCy 101 course !!!ù*`^@😀&quot;</span><span class="p">,</span>
            <span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;loving&quot;</span><span class="p">,</span> <span class="s2">&quot;spacy&quot;</span><span class="p">,</span> <span class="s2">&quot;course&quot;</span><span class="p">],</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;item&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;br/&gt;prepare things for IMDB&lt;br/&gt;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;prepare&quot;</span><span class="p">,</span> <span class="s2">&quot;things&quot;</span><span class="p">,</span> <span class="s2">&quot;imdb&quot;</span><span class="p">],</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;item&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;br/&gt;a b c data&lt;br/&gt;      e scientist&quot;</span><span class="p">,</span>
            <span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="s2">&quot;scientist&quot;</span><span class="p">,</span> <span class="s2">&quot;failing&quot;</span><span class="p">,</span> <span class="s2">&quot;test&quot;</span><span class="p">],</span>
        <span class="p">},</span>  <span class="c1"># fails as intended</span>
    <span class="p">]</span>

    <span class="k">def</span> <span class="nf">_load</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nlp</span> <span class="o">=</span> <span class="n">spacy</span><span class="o">.</span><span class="n">load</span><span class="p">(</span>
            <span class="s2">&quot;en_core_web_sm&quot;</span><span class="p">,</span>
            <span class="n">disable</span><span class="o">=</span><span class="p">[</span>
                <span class="s2">&quot;parser&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ner&quot;</span><span class="p">,</span>
                <span class="s2">&quot;tagger&quot;</span><span class="p">,</span>
                <span class="s2">&quot;lemmatizer&quot;</span><span class="p">,</span>
                <span class="s2">&quot;tok2vec&quot;</span><span class="p">,</span>
                <span class="s2">&quot;attribute_ruler&quot;</span><span class="p">,</span>
            <span class="p">],</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_predict_batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">texts</span><span class="p">):</span>
        <span class="n">texts</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&lt;br&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;/&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
            <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">texts</span>
        <span class="p">]</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="p">[</span>
                <span class="n">t</span><span class="o">.</span><span class="n">lower_</span>
                <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">text</span>
                <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">is_ascii</span>
                <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span>
                <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">is_punct</span> <span class="ow">or</span> <span class="n">t</span><span class="o">.</span><span class="n">is_stop</span> <span class="ow">or</span> <span class="n">t</span><span class="o">.</span><span class="n">is_digit</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nlp</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">texts</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">texts</span><span class="p">))</span>
        <span class="p">]</span>
</code></pre></div>
<p>You can run these test cases in the interactive programming tool of your choice (e.g. <code>ipython</code>, <code>jupyter</code> etc.) using the <code>test</code> method:</p>
<div class="highlight"><pre><span></span><code><span class="n">Tokenizer</span><span class="p">()</span><span class="o">.</span><span class="n">test</span><span class="p">()</span>
<span class="c1"># TEST 1: SUCCESS</span>
<span class="c1"># TEST 2: SUCCESS</span>
<span class="c1"># TEST 3: SUCCESS</span>
<span class="c1"># TEST 4: SUCCESS</span>
<span class="c1"># TEST 5: FAILED test failed on item</span>
<span class="c1"># item = &#39;&lt;br/&gt;a b c data&lt;br/&gt;      e scientist&#39;                                               </span>
<span class="c1"># expected = list instance                                                                     </span>
<span class="c1"># result = list instance                                                                       </span>
</code></pre></div>
<details class="note">
<summary>Run using pytest</summary>
<p>It is also possible to automatically test all models using the <code>pytest</code> integration, using <a href="../../../library/models/testing/#modellibrary-fixture-and-autotesting">the Modelkit autotesting fixture</a>.</p>
</details>
<p>Woops, seems like we need to fix the last test!</p>
<h3 id="input-and-output-specification">Input and output specification<a class="headerlink" href="#input-and-output-specification" title="Permanent link">&para;</a></h3>
<p>It is good practice to specify inputs and outputs of models in production code</p>
<p>This allows calls to be validated, thus ensuring consistency between calls, dependencies, services, and raising alerts when Models are not called as expected.</p>
<p>This is also good for documentation, to understand how to use a given model, and during development to benefit from static type checking (e.g. with <a href="https://github.com/python/mypy">mypy</a>).</p>
<p><code>modelkit</code> allows you to define the expected input and output types of your model by subclassing <code>Model[input_type, output_type]</code>, where <code>input_type</code> and <code>output_type</code> can be standard Python types, dataclasses, or complex <a href="https://pydantic-docs.helpmanual.io/">pydantic</a> models.</p>
<p>Let's add specification our Tokenizer to conclude this first part:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span>

<span class="kn">import</span> <span class="nn">modelkit</span>
<span class="kn">import</span> <span class="nn">spacy</span>


<span class="k">class</span> <span class="nc">Tokenizer</span><span class="p">(</span><span class="n">modelkit</span><span class="o">.</span><span class="n">Model</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]):</span>
    <span class="n">TEST_CASES</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">{</span><span class="s2">&quot;item&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="p">[]},</span>
        <span class="p">{</span><span class="s2">&quot;item&quot;</span><span class="p">:</span> <span class="s2">&quot;NLP 101&quot;</span><span class="p">,</span> <span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;nlp&quot;</span><span class="p">]},</span>
        <span class="p">{</span>
            <span class="s2">&quot;item&quot;</span><span class="p">:</span> <span class="s2">&quot;I&#39;m loving the spaCy 101 course !!!ù*`^@😀&quot;</span><span class="p">,</span>
            <span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;loving&quot;</span><span class="p">,</span> <span class="s2">&quot;spacy&quot;</span><span class="p">,</span> <span class="s2">&quot;course&quot;</span><span class="p">],</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;item&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;br/&gt;prepare things for IMDB&lt;br/&gt;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;prepare&quot;</span><span class="p">,</span> <span class="s2">&quot;things&quot;</span><span class="p">,</span> <span class="s2">&quot;imdb&quot;</span><span class="p">],</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;item&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;br/&gt;a b c data&lt;br/&gt;      e scientist&quot;</span><span class="p">,</span>
            <span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="s2">&quot;scientist&quot;</span><span class="p">,</span> <span class="s2">&quot;failing&quot;</span><span class="p">,</span> <span class="s2">&quot;test&quot;</span><span class="p">],</span>
        <span class="p">},</span>  <span class="c1"># fails as intended</span>
    <span class="p">]</span>

    <span class="k">def</span> <span class="nf">_load</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nlp</span> <span class="o">=</span> <span class="n">spacy</span><span class="o">.</span><span class="n">load</span><span class="p">(</span>
            <span class="s2">&quot;en_core_web_sm&quot;</span><span class="p">,</span>
            <span class="n">disable</span><span class="o">=</span><span class="p">[</span>
                <span class="s2">&quot;parser&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ner&quot;</span><span class="p">,</span>
                <span class="s2">&quot;tagger&quot;</span><span class="p">,</span>
                <span class="s2">&quot;lemmatizer&quot;</span><span class="p">,</span>
                <span class="s2">&quot;tok2vec&quot;</span><span class="p">,</span>
                <span class="s2">&quot;attribute_ruler&quot;</span><span class="p">,</span>
            <span class="p">],</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_predict_batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">texts</span><span class="p">):</span>
        <span class="n">texts</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&lt;br&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;/&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
            <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">texts</span>
        <span class="p">]</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="p">[</span>
                <span class="n">t</span><span class="o">.</span><span class="n">lower_</span>
                <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">text</span>
                <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">is_ascii</span>
                <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span>
                <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">is_punct</span> <span class="ow">or</span> <span class="n">t</span><span class="o">.</span><span class="n">is_stop</span> <span class="ow">or</span> <span class="n">t</span><span class="o">.</span><span class="n">is_digit</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nlp</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">texts</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">texts</span><span class="p">))</span>
        <span class="p">]</span>
</code></pre></div>
<p>Calling the model with an unexpected type will raise a Modelkit <code>ItemValidationException</code>:</p>
<div class="highlight"><pre><span></span><code><span class="n">Tokenizer</span><span class="p">()</span><span class="o">.</span><span class="n">predict</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
</code></pre></div>
<p>And <code>mypy</code> will raise errors if it encounters calls that are not correct:
<div class="highlight"><pre><span></span><code><span class="n">result</span> <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Tokenizer</span><span class="p">()</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="s2">&quot;some text&quot;</span><span class="p">)</span>
</code></pre></div></p>
<h2 id="conclusion">Conclusion<a class="headerlink" href="#conclusion" title="Permanent link">&para;</a></h2>
<p>That's it! </p>
<p>In this <code>modelkit</code> introduction, you have learned:</p>
<ul>
<li>How to create a basic <code>Model</code> by inheriting from <code>modelkit.Model</code> and implementing a <code>_predict</code> method</li>
<li>How to correctly <em>load</em> artefacts/assets by overriding the <code>_load</code> method</li>
<li>How to leverage <em>batch computing</em> to speed up execution by implementing a <code>_predict_batch</code> method</li>
<li>How to <em>add tests</em> to ensure everything works as intended using <code>TEST_CASES</code> right in your model definition</li>
<li>How to add specification to your model's inputs and outputs using <code>modelkit.Model[input_type, output_type]</code></li>
</ul>
<h3 id="final-tokenizer-code">Final Tokenizer code<a class="headerlink" href="#final-tokenizer-code" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span>

<span class="kn">import</span> <span class="nn">modelkit</span>
<span class="kn">import</span> <span class="nn">spacy</span>


<span class="k">class</span> <span class="nc">Tokenizer</span><span class="p">(</span><span class="n">modelkit</span><span class="o">.</span><span class="n">Model</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]):</span>
    <span class="n">CONFIGURATIONS</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;imdb_tokenizer&quot;</span><span class="p">:</span> <span class="p">{}}</span>
    <span class="n">TEST_CASES</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">{</span><span class="s2">&quot;item&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="p">[]},</span>
        <span class="p">{</span><span class="s2">&quot;item&quot;</span><span class="p">:</span> <span class="s2">&quot;NLP 101&quot;</span><span class="p">,</span> <span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;nlp&quot;</span><span class="p">]},</span>
        <span class="p">{</span>
            <span class="s2">&quot;item&quot;</span><span class="p">:</span> <span class="s2">&quot;I&#39;m loving the spaCy 101 course !!!ù*`^@😀&quot;</span><span class="p">,</span>
            <span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;loving&quot;</span><span class="p">,</span> <span class="s2">&quot;spacy&quot;</span><span class="p">,</span> <span class="s2">&quot;course&quot;</span><span class="p">],</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;item&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;br/&gt;prepare things for IMDB&lt;br/&gt;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;prepare&quot;</span><span class="p">,</span> <span class="s2">&quot;things&quot;</span><span class="p">,</span> <span class="s2">&quot;imdb&quot;</span><span class="p">],</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;item&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;br/&gt;a b c data&lt;br/&gt;      e scientist&quot;</span><span class="p">,</span>
            <span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="s2">&quot;scientist&quot;</span><span class="p">],</span>
        <span class="p">},</span>
    <span class="p">]</span>

    <span class="k">def</span> <span class="nf">_load</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nlp</span> <span class="o">=</span> <span class="n">spacy</span><span class="o">.</span><span class="n">load</span><span class="p">(</span>
            <span class="s2">&quot;en_core_web_sm&quot;</span><span class="p">,</span>
            <span class="n">disable</span><span class="o">=</span><span class="p">[</span>
                <span class="s2">&quot;parser&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ner&quot;</span><span class="p">,</span>
                <span class="s2">&quot;tagger&quot;</span><span class="p">,</span>
                <span class="s2">&quot;lemmatizer&quot;</span><span class="p">,</span>
                <span class="s2">&quot;tok2vec&quot;</span><span class="p">,</span>
                <span class="s2">&quot;attribute_ruler&quot;</span><span class="p">,</span>
            <span class="p">],</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_predict_batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">texts</span><span class="p">):</span>
        <span class="n">texts</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&lt;br&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;/&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
            <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">texts</span>
        <span class="p">]</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="p">[</span>
                <span class="n">t</span><span class="o">.</span><span class="n">lower_</span>
                <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">text</span>
                <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">is_ascii</span>
                <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span>
                <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">is_punct</span> <span class="ow">or</span> <span class="n">t</span><span class="o">.</span><span class="n">is_stop</span> <span class="ow">or</span> <span class="n">t</span><span class="o">.</span><span class="n">is_digit</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nlp</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">texts</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">texts</span><span class="p">))</span>
        <span class="p">]</span>
</code></pre></div>
<p>As you may have seen, there is a <code>CONFIGURATIONS</code> map in the class definition, we will cover it in the next section.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["tabs", "navigation.indexes", "navigation.instant"], "search": "../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.ad660dcc.min.js"></script>
      
    
  </body>
</html>